<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Prediksi Skor</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100">

<div class="max-w-xl mx-auto mt-10 bg-white p-6 rounded shadow">
  <h1 class="text-xl font-bold mb-3">Prediksi Skor</h1>

  <input id="name" placeholder="Nama kamu" class="w-full p-2 mb-2 border rounded">

  <select id="match" onchange="loadTaken()" class="w-full p-2 mb-2 border rounded"></select>

  <div id="taken" class="text-sm mb-2"></div>

  <div class="flex gap-2 mb-2">
    <input id="homeScore" type="number" placeholder="Home" class="w-1/2 p-2 border rounded">
    <input id="awayScore" type="number" placeholder="Away" class="w-1/2 p-2 border rounded">
  </div>

  <button onclick="submit()" class="w-full bg-blue-600 text-white p-2 rounded">
    Kirim Prediksi
  </button>
</div>

<script>
const API = 'https://prediksi-skor.onrender.com';

async function loadMatches() {
  const r = await fetch(API + '/matches');
  const d = await r.json();
  const s = document.getElementById('match');
  s.innerHTML = '';
  d.forEach(m => s.innerHTML += `<option value="${m.id}">${m.pertandingan} (${m.status})</option>`);
  loadTaken();
}

async function loadTaken() {
  const id = match.value;
  const r = await fetch(API + '/scores/' + id);
  const d = await r.json();
  taken.innerHTML = '<b>Skor dipilih:</b><br>' +
    (d.length ? d.map(x => `${x.name} : ${x.home_score}-${x.away_score}`).join('<br>') : '-');
}

async function submit() {
  const res = await fetch(API + '/predict', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      name: name.value,
      matchId: match.value,
      homeScore: Number(homeScore.value),
      awayScore: Number(awayScore.value)
    })
  });
  const d = await res.json();
  alert(d.message);
  loadTaken();
}

loadMatches();
</script>
</body>
</html>
