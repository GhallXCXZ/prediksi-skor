<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Prediksi Skor</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100 transition-colors duration-300">

<button onclick="toggleTheme()" class="fixed top-4 right-4 p-3 rounded-full bg-white dark:bg-gray-800 shadow">
  <span id="theme-icon">üåô</span>
</button>

<div class="max-w-xl mx-auto mt-20 bg-white dark:bg-gray-800 p-6 rounded shadow">
  <h1 class="text-xl font-bold mb-4">Prediksi Skor</h1>

  <input id="name" placeholder="Nama kamu" class="w-full p-2 mb-2 rounded bg-gray-50 dark:bg-gray-700">

  <select id="match" class="w-full p-2 mb-2 rounded bg-gray-50 dark:bg-gray-700"></select>

  <div class="flex gap-2 mb-2">
    <input id="homeScore" type="number" placeholder="Skor Home" class="w-1/2 p-2 rounded bg-gray-50 dark:bg-gray-700">
    <input id="awayScore" type="number" placeholder="Skor Away" class="w-1/2 p-2 rounded bg-gray-50 dark:bg-gray-700">
  </div>

  <button onclick="submitPrediction()" class="w-full bg-blue-600 text-white p-2 rounded">
    Kirim Prediksi
  </button>
</div>

<script>
const API = 'https://prediksi-skor.onrender.com';

async function loadMatches() {
  const res = await fetch(API + '/matches');
  const data = await res.json();
  const select = document.getElementById('match');
  data.forEach(m => {
    const opt = document.createElement('option');
    opt.value = m.id;
    opt.textContent = `${m.home} vs ${m.away}`;
    select.appendChild(opt);
  });
}

async function submitPrediction() {
  const name = document.getElementById('name').value;
  const matchId = document.getElementById('match').value;
  const homeScore = document.getElementById('homeScore').value;
  const awayScore = document.getElementById('awayScore').value;

  const res = await fetch(API + '/predict', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      name,
      matchId,
      homeScore: Number(homeScore),
      awayScore: Number(awayScore)
    })
  });

  const data = await res.json();
  alert(data.message);
}

const html = document.documentElement;
const icon = document.getElementById('theme-icon');

function applyTheme(theme) {
  if (theme === 'dark') {
    html.classList.add('dark');
    icon.textContent = '‚òÄÔ∏è';
  } else {
    html.classList.remove('dark');
    icon.textContent = 'üåô';
  }
}

const savedTheme = localStorage.getItem('theme');
if (savedTheme) {
  applyTheme(savedTheme);
} else {
  applyTheme(window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
}

function toggleTheme() {
  const theme = html.classList.contains('dark') ? 'light' : 'dark';
  localStorage.setItem('theme', theme);
  applyTheme(theme);
}

loadMatches();
</script>
</body>
</html>
