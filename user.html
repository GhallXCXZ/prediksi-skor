<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Prediksi Skor</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen p-6">

<div class="max-w-3xl mx-auto">
  <h1 class="text-3xl font-bold mb-6">âš½ Prediksi Skor Pertandingan</h1>

  <div id="matchList" class="space-y-4"></div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {

  const API = 'http://localhost:3000';

  async function loadMatches() {
    const res = await fetch(API + '/matches');
    const matches = await res.json();
    const list = document.getElementById('matchList');
    list.innerHTML = '';

    matches.forEach(m => {
      if (m.status !== 'OPEN') return;

      list.innerHTML += `
        <div class="bg-white p-4 rounded shadow">
          <h2 class="font-bold text-lg mb-2">${m.pertandingan}</h2>

          <div class="flex gap-2 mb-2">
            <input id="home-${m.id}" type="number" min="0"
              class="border p-2 w-1/2" placeholder="Skor Tim 1" />
            <input id="away-${m.id}" type="number" min="0"
              class="border p-2 w-1/2" placeholder="Skor Tim 2" />
          </div>

          <button
            onclick="kirimPrediksi(${m.id})"
            class="bg-green-600 text-white px-4 py-2 rounded">
            Kirim Prediksi
          </button>
        </div>
      `;
    });
  }

  window.kirimPrediksi = async function(matchId) {
    const home = document.getElementById(`home-${matchId}`).value;
    const away = document.getElementById(`away-${matchId}`).value;

    if (home === '' || away === '') {
      alert('Skor harus diisi');
      return;
    }

    if (home === away) {
      alert('Skor tidak boleh seri');
      return;
    }

    const res = await fetch(API + '/predict', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        match_id: matchId,
        skor_rumah: home,
        skor_tamu: away
      })
    });

    const data = await res.json();
    if (!res.ok) {
      alert(data.error);
    } else {
      alert('Prediksi berhasil dikirim!');
    }
  }

  loadMatches();

});
</script>

</body>
</html>
